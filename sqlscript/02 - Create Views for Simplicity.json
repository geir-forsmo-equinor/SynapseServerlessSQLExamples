{
	"name": "02 - Create Views for Simplicity",
	"properties": {
		"content": {
			"query": "--This view is for access to year-month-day partitioioned data\nCREATE VIEW nycyellow_ym AS\nSELECT\n    CAST(vendorId as INT) as vendorId,\n    CAST(tpepPickupDateTime as DATETIME) as tpepPickupDateTime,\n    CAST(tpepDropoffDateTime as DATETIME) as tpepDropoffDateTime,\n    passengerCount,\n    tripDistance,\n    puLocationId,\n    doLocationId,\n    startLon,\n    startLat,\n    endLon,\n    endLat,\n    rateCodeId,\n    storeAndFwdFlag,\n    paymentType,\n    fareAmount,\n    extra,\n    mtaTax,\n    improvementSurcharge,\n    tipAmount,\n    tollsAmount,\n    totalAmount,\n    CAST(result.filepath(1) as INT) as puYear,\n    CAST(result.filepath(2) as INT) as puMonth\nFROM\n    OPENROWSET(\n        BULK 'https://cgmsynapsewpbi.dfs.core.windows.net/default/output/nycyellow-ymd/puYear=*/puMonth=*/*.parquet',\n        FORMAT = 'PARQUET'\n    ) AS [result]\n\n--This view is for access to year-month-day partitioioned data\nCREATE VIEW nycyellow_ymd AS\nSELECT\n    CAST(vendorId as INT) as vendorId,\n    CAST(tpepPickupDateTime as DATETIME) as tpepPickupDateTime,\n    CAST(tpepDropoffDateTime as DATETIME) as tpepDropoffDateTime,\n    passengerCount,\n    tripDistance,\n    puLocationId,\n    doLocationId,\n    startLon,\n    startLat,\n    endLon,\n    endLat,\n    rateCodeId,\n    storeAndFwdFlag,\n    paymentType,\n    fareAmount,\n    extra,\n    mtaTax,\n    improvementSurcharge,\n    tipAmount,\n    tollsAmount,\n    totalAmount,\n    CAST(result.filepath(1) as INT) as puYear,\n    CAST(result.filepath(2) as INT) as puMonth,\n    CAST(result.filepath(3) as INT) as puDay\nFROM\n    OPENROWSET(\n        BULK 'https://cgmsynapsewpbi.dfs.core.windows.net/default/output/nycyellow-ymd/puYear=*/puMonth=*/puDay=*/*.parquet',\n        FORMAT = 'PARQUET'\n    ) AS [result]\n\n\n\n--Views simplify this\nCREATE VIEW nycyellow_ymdate AS\nSELECT\n    CAST(vendorId as INT) as vendorId,\n    CAST(tpepPickupDateTime as DATETIME) as tpepPickupDateTime,\n    CAST(tpepDropoffDateTime as DATETIME) as tpepDropoffDateTime,\n    passengerCount,\n    tripDistance,\n    puLocationId,\n    doLocationId,\n    startLon,\n    startLat,\n    endLon,\n    endLat,\n    rateCodeId,\n    storeAndFwdFlag,\n    paymentType,\n    fareAmount,\n    extra,\n    mtaTax,\n    improvementSurcharge,\n    tipAmount,\n    tollsAmount,\n    totalAmount,\n    CAST(result.filepath(1) as INT) as puYear,\n    CAST(result.filepath(2) as INT) as puMonth,\n    CAST(result.filepath(3) as DATE) as puDate\nFROM\n    OPENROWSET(\n        BULK 'https://cgmsynapsewpbi.dfs.core.windows.net/default/output/nycyellow-ymdate/puYear=*/puMonth=*/puDate=*/*.parquet',\n        FORMAT = 'PARQUET'\n    ) AS [result]\n\n--Views simplify this\nCREATE VIEW nycyellow_ymdate_delta AS\nSELECT\n    CAST(vendorId as INT) as vendorId,\n    CAST(tpepPickupDateTime as DATETIME) as tpepPickupDateTime,\n    CAST(tpepDropoffDateTime as DATETIME) as tpepDropoffDateTime,\n    passengerCount,\n    tripDistance,\n    puLocationId,\n    doLocationId,\n    startLon,\n    startLat,\n    endLon,\n    endLat,\n    rateCodeId,\n    storeAndFwdFlag,\n    paymentType,\n    fareAmount,\n    extra,\n    mtaTax,\n    improvementSurcharge,\n    tipAmount,\n    tollsAmount,\n    totalAmount,\n    puYear,\n    puMonth,\n    puDate\nFROM\n    OPENROWSET(\n        BULK 'https://cgmsynapsewpbi.dfs.core.windows.net/default/output/nycyellow-ymdate-delta/',\n        FORMAT = 'DELTA'\n    ) AS [result]\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}